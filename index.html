<!DOCTYPE HTML>
<html>
    <header>
        <meta charset="UTF-8">
        <title>Date and Time UTC</title>
    </header>
    <body>
        <pre id="json-data"></pre>

        <script>
            function getDateTime() {
                const now = new Date();
                const utcString = now.toISOString().slice(0, 19).replace("T", " ");
                return utcString;
            }

            async function updateDateTime() {
                const dateTimeString = getDateTime();
                const jsonData = { dateTime: dateTimeString };
                const jsonString = JSON.stringify(jsonData, null, 2);

                const shaResponse = await fetch('https://api.github.com/repos/BlazeCreates/UTC-Date-Time/contents/date-time.json', {
                    method: 'GET',
                    headers: {
                        'Authorization': 'Bearer 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',
                        'Content-Type': 'application/json',
                    },
                });

                if (shaResponse.ok) {
                    const shaData = await shaResponse.json();
                    const sha = shaData.sha;

                    const updateResponse = await fetch('https://api.github.com/repos/BlazeCreates/UTC-Date-Time/contents/date-time.json', {
                        method: 'PUT',
                        headers: {
                            'Authorization': 'Bearer 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',
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            message: 'Update date-time.json',
                            content: btoa(jsonString),
                            sha: sha,
                        }),
                    });

                    if (updateResponse.ok) {
                        document.getElementById("json-data").textContent = jsonString;
                    }
                }
            }

            setInterval(updateDateTime, 1000);
            updateDateTime();

            window.getDateTime = getDateTime;
        </script>
    </body>
</html>
